import {config} from './config';
import {SetupSeal, SEALFunction} from './fHE';

/**
 * @param {File} file
 * @return {json}
 */
async function requestScanFile(file) {
    let encrypt = await SetupSeal(SEALFunction.Encrypt);
    const data = encrypt(await file.slice().arrayBuffer());
    const response = await fetch(config.hosturi + '/scan', {
        method: 'POST',
        body: JSON.stringify({ name: file.name, data: data }, 
                (key, value) =>
                typeof value === 'bigint'
                    ? value.toString()
                    : value 
            ),
        headers: {
            'Content-Type': 'application/json'
        }
    });
    const resObj = await response.json();
    return resObj;
}

export {requestScanFile};