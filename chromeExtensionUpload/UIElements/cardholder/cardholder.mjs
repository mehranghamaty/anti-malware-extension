import CardItem from "@UIElements/carditem.mjs";
import InfoCard from "@UIElements/infocard.mjs";

/**
 * @class CardHolder
 */
export default class CardHolder extends HTMLElement {
    constructor() {
        super();
        this._infocard = new InfoCard();

        this._infocard.setMessage(this.innerHTML);
        this.innerHTML = '';
        this.appendChild(this._infocard); 
        //this.onscroll = this.checkFlows.bind(this);
        //this.addEventListener("scroll", this.checkFlows.bind(this), {passive: false});
    }

    /**
    checkFlows() {
        const isScrollable = this.scrollHeight > this.clientHeight;

        if (!isScrollable) {
            this.classList.remove('lower-fade', 'upper-fade');
            return;
        }
        
        // Otherwise, the element is overflowing!
        // Now we just need to find out which direction it is overflowing to (can be both)
        const isScrolledToBottom = this.scrollHeight <= this.clientHeight + this.scrollTop;
        const isScroledlToTop = this.scrollTop === 0;
        this.classList.toggle('lower-fade', !isScrolledToBottom);
        this.classList.toggle('upper-fade', !isScroledlToTop);
    }
     */
    
    /**
     * @param {File} file 
     */
    async addCardFromFile(file) {
        let cardItem = new CardItem(this.setErrorAlert.bind(this));
        cardItem.setFile(file);
        this.appendChild(cardItem);
        this.checkFlows();
        this._infocard.hide();
    }

    setErrorAlert(message) {
        this._infocard.show();
        this._infocard.setMessage(message);
    }
}

customElements.define("card-holder", CardHolder);