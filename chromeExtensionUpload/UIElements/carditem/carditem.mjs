import AncilliaryButton from '../ancilliarybutton/ancilliarybutton.mjs';
import InfoTag from '../infotag/infotag.mjs';

/**
 * Tag populates the inner items itself.
 * <card-item>
 *  <p uri>http://Downloadpath...</p>
 *  <div status></div>
 *  <ancilliary-button></ancilliary-button>
 *  <info-tag></info-tag>
 * </card-item>
 * @class CardItem
 */
export default class CardItem extends HTMLElement {
    constructor() {
        super();

        this._uri = document.createElement("p");
        this._uri.setAttribute("uri", "");

        this._status = document.createElement("div");
        this._status.setAttribute("status", "");

        this._ancilliarybutton = new AncilliaryButton();
        this._infotag = new InfoTag();

        this.appendChild(this._uri);
        this.appendChild(this._status);
        this.appendChild(this._ancilliarybutton);
        this.appendChild(this._infotag);

        if(this.classList.length != 0) {
            this._infotag.classList.add(this.classList);
        }

        if(this.classList.contains("safe")) {
            this.setSafe();
        } else if(this.classList.contains("warning")) {
            this.setWarning();
        } else if(this.classList.contains("malicious")) {
            this._status.innerHTML = "Reported as possibly malicious";
            this.setMalicious();
        } else {
            this._progressbar = document.createElement("progress");
            this._progressbar.setAttribute("max", "100");
            this._progressbar.setAttribute("value", "50");
            this._status.appendChild(this._progressbar);
        }
    }

    /**
     * @param {File} file
     */
    setFile(file) {
        this._uri.textContent = file.name;
    }

    setSafe() {
        this.classList.remove("warning", "malicious");
        this.classList.add("safe");
        this._status.innerHTML = "Looks safe to download!";
        this._ancilliarybutton.setDownload("here?");
    }

    setWarning() {
        this.classList.remove("safe", "malicious");
        this.classList.add("warning");
        this._status.innerHTML = "Something went wrong";

        let callback = () => {console.log("hello world");};

        this._ancilliarybutton.setRetry(callback);
    }

    setMalicious() {
        this.classList.remove("safe", "warning");
        this.classList.add("malicious");
        this._status.innerHTML = "Reported as possibly malicious";
        this._ancilliarybutton.setNoDownload("theres no file!");
    }


}

customElements.define("card-item", CardItem);