import pefile
import joblib
from helpers import toDF

class ModelWrapper:
    def __init__(self, path) -> None:
        self.model_ = joblib.load(path)

    def predict(self, filePath) -> int:
        pe = pefile.PE(filePath)
        input = toDF(pe.header)
        pred = int(self.model_.predict(input)[0])
        return pred
