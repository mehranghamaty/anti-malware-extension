import pefile
import joblib
from utility.helpers import toDF

class ModelWrapper:
    def __init__(self, path) -> None:
        self.model_ = joblib.load(path)

    def predict(self, data) -> int:
        pe = pefile.PE(data=data)
        input = toDF(pe.header)
        pred = int(self.model_.predict(input)[0])
        return pred