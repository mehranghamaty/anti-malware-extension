import pandas as pd
# Configuration constants
can_scan = {'exe', 'dll', 'sys', 'drv', 'ocx', 'cpl', 'scr'}

# Helper Functions
def toArray(uintArray):
    res = []
    for k, v in uintArray.items():
        res.append(v)
    return res

def getAfter(uri: str, delim: str) -> str:
    return uri[uri.rfind(delim)+1:]

def getExtension(uri: str) -> str:
    return getAfter(uri, '.')

def getFile(uri: str) -> str:
    return getAfter(uri, '/')

def scannable(uri):
    return getExtension(uri) in can_scan

def toDF(bytearray):
    return pd.DataFrame.from_dict({'pixel{}'.format(i+1) : [b] for i, b in enumerate(bytearray)})


def lastItem(iteraterable):
    it = iter(iteraterable)
    last = next(it)
    for val in it:
        yield last, False
        last = val
    yield last, True